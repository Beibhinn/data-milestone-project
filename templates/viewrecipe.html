{% extends 'base.html' %}
{% set is_signed_in = 'username' in session %}
{% set is_owner = session['username'] == recipe.user_name %}
{% block content %}
<div class="row">

    <div class="col s12">
        <div class="card">
            <div class="card-image single-card">
                <img src="{{recipe.photo_src}}">
                {% if is_owner %}
                    <a href="{{url_for('delete_recipe', recipe_id=recipe._id)}}"
                       class="btn-floating halfway-fab waves-effect waves-light red"><i
                            class="material-icons">delete</i></a>
                    <a href="{{url_for('edit_recipe', recipe_id=recipe._id)}}"
                       class="btn-floating halfway-fab waves-effect waves-light blue"><i
                            class="material-icons">mode_edit</i></a>
                {% endif %}
            </div>
            <div class="card-content">
                <span class="card-title activator grey-text text-darken-4">{{recipe.title}}</span>
                <p>By <a href="{{url_for('user_recipes', user_name=recipe.user_name)}}">{{recipe.user_name}}</a></p>
                <p>Cuisine: <a href="{{url_for('cuisine_recipes', cuisine_name=recipe.cuisine_name)}}">{{recipe.cuisine_name}}</a>
                </p>
                <div>
                    <h6>Ingredients</h6>
                    <ul>
                        {% for item in recipe.ingredients %}
                        <li>{{ item }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div>
                    <h6>Method</h6>
                    <ol>
                        {% for list in recipe.method %}
                        <li>{{ list }}</li>
                        {% endfor %}
                    </ol>
                </div>
            </div>
            <div class="card-action">
                {% for tag in recipe.tag_name %}
                <a href="">
                    <div class="chip">
                        {{ tag }}
                        {% if is_owner %}
                            <i class="material-icons close">close</i>
                        {% endif %}
                    </div>
                </a>
                {% endfor %}
                {% if is_signed_in and not is_owner %}
                <div class="right">
                    <form id="preference-form" action="" method="">
                        <input type="checkbox" name="like-input" id="like-input" style="display:none"/> <label for="like-input"
                                                                                          style="font-size:18pt"><i
                            id="like"
                            onclick="toggleLike()"
                            class="far fa-thumbs-up"></i></label>
                        <input type="checkbox" name="fav-input" id="fav-input" style="display:none"/> <label for="fav-input"
                                                                                        style="font-size:18pt"><i
                            id="favourite"
                            onclick="toggleFav()"
                            class="far fa-heart"></i></label>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

</div>
{% endblock %}

{% block scripts %}

<script>
    function toggleFav() {
        $("#favourite").toggleClass("fas").toggleClass("far");
    }

    function toggleLike() {
        $("#like").toggleClass("fas").toggleClass("far");
    }

    if($("#fav-input").attr('checked', true)) {
        $("#favourite").addClass("fas").removeClass("far");
    }

    if($("#like-input").attr('checked', true)) {
        $("#like").addClass("fas").removeClass("far");
    }


    if ($("#favourite").hasClass("fas")) {
        $('#fav-input').prop('checked', true);
    } else {
        $('#fav-input').prop('checked', false);
    }

    if ($("#like").hasClass("fas")) {
        $('#like-input').prop('checked', true);
    } else {
        $('#like-input').prop('checked', false);
    }


</script>

{% endblock %}